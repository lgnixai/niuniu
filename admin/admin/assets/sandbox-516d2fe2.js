import{d as C,r,x as M,f as F,n as J,Q as L,l as K,h as v,c as D,e,w as a,R as j,s as q,u as E,q as T,F as H,T as Q,i as k,t as Y,K as $,L as z,aN as G,aO as P,ac as W,aD as X,E as Z,M as ee,a7 as te,Y as ae}from"./index-6405d5ac.js";/* empty css                   *//* empty css                *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                 */import{b as le,m as oe}from"./index-f15665f6.js";import{b as se,i as ne,j as ie,k as re,s as ue}from"./api-c38e4264.js";import{_ as de}from"./_plugin-vue_export-helper-c27b6911.js";const pe={class:"main-container"},me=C({__name:"sandbox",setup(_e){r(!1);const m=M();F();const _=r(!1),w=r([]),u=r(0),y=r(),g=r(),R={site_id:"",api_id:"",api_name:"",api_key:"",api_secret:"",callback_url:"",request_data:"",url:""};m.meta.title;const l=J({...R});l.id=r(m.query.id),console.log(m.query.id);const V=r();m.query.id&&(_.value=!0,se(m.query.id).then(({data:n})=>{n&&(Object.keys(l).forEach(t=>{n[t]!=null&&(l[t]=n[t])}),l.value=n.fee_data,u.value=1801),_.value=!1}).catch(()=>{_.value=!1}));const S=async()=>{w.value=await(await ie()).data},h=async()=>{g.value=await(await re()).data,l.url=g.value};S(),h(),L(u,()=>{u.value&&ne(l.site_id,u.value).then(({data:n})=>{n&&(l.api_id=u,l.request_data=JSON.stringify(n,null,2))}).catch(()=>{})});const N=K(()=>({})),c=r(!1),B=async n=>{c.value||!n||await n.validate(async t=>{if(t){c.value=!0;const o=l,i=JSON.parse(o.request_data),f=o.api_secret;o.EBusinessID=o.api_key,o.RequestData=JSON.stringify(i),o.RequestType=o.api_id;const d=le.Buffer.from(oe(JSON.stringify(i)+f)).toString("base64");o.DataSign=encodeURIComponent(d),ue(g.value,o).then(p=>{c.value=!1;let b=p;console.log(p),y.value=JSON.stringify(b,null,2)}).catch(p=>{console.log(p),c.value=!1})}})};return(n,t)=>{const o=$,i=z,f=G,d=P,p=W,b=X,O=Z,I=ee,U=te,A=ae;return v(),D("div",pe,[e(U,{class:"box-card !border-none",shadow:"never"},{default:a(()=>[j((v(),q(I,{model:l,"label-width":"120px",ref_key:"formRef",ref:V,rules:E(N),class:"page-form"},{default:a(()=>[e(d,{gutter:20},{default:a(()=>[e(f,{span:12},{default:a(()=>[e(i,{label:"请求报文内容",prop:"template_name","label-position":"top"},{default:a(()=>[e(o,{modelValue:l.request_data,"onUpdate:modelValue":t[0]||(t[0]=s=>l.request_data=s),modelModifiers:{trim:!0},type:"textarea",rows:14,placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:12},{default:a(()=>[e(i,{label:"返回报文",prop:"template_name","label-position":"top"},{default:a(()=>[e(o,{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=s=>y.value=s),modelModifiers:{trim:!0},type:"textarea",rows:14,placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:20},{default:a(()=>[e(i,{label:"EBusinessID",prop:"template_name"},{default:a(()=>[e(o,{modelValue:l.api_key,"onUpdate:modelValue":t[2]||(t[2]=s=>l.api_key=s),modelModifiers:{trim:!0},class:"input-width"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{gutter:20},{default:a(()=>[e(i,{label:"Key",prop:"template_name"},{default:a(()=>[e(o,{modelValue:l.api_secret,"onUpdate:modelValue":t[3]||(t[3]=s=>l.api_secret=s),modelModifiers:{trim:!0},class:"input-width",style:{width:"600px"}},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{gutter:20},{default:a(()=>[e(i,{label:"请求地址",prop:"template_name"},{default:a(()=>[e(o,{modelValue:l.url,"onUpdate:modelValue":t[4]||(t[4]=s=>l.url=s),modelModifiers:{trim:!0},class:"input-width",style:{width:"600px"}},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{gutter:20},{default:a(()=>[e(i,{label:E(T)("status"),prop:"status"},{default:a(()=>[e(b,{modelValue:u.value,"onUpdate:modelValue":t[5]||(t[5]=s=>u.value=s),clearable:"",placeholder:"选择测试接口",class:"input-width"},{default:a(()=>[(v(!0),D(H,null,Q(w.value,(s,x)=>(v(),q(p,{label:s,value:x,key:x},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),k(" "+Y(u.value),1)]),_:1},8,["label"])]),_:1}),e(d,{gutter:20},{default:a(()=>[e(i,null,{default:a(()=>[e(O,{type:"primary",onClick:t[6]||(t[6]=s=>B(V.value))},{default:a(()=>[k("发送")]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[A,_.value]])]),_:1})])}}});const he=de(me,[["__scopeId","data-v-f13e7206"]]);export{he as default};
