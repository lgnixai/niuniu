import{d as M,r as u,x as L,f as F,n as K,Q as w,l as A,h as v,c as D,e as a,w as o,R as T,s as q,u as C,q as j,F as H,T as Q,i as x,t as Y,K as $,L as z,aN as G,aO as P,ac as W,aD as X,E as Z,M as ee,a7 as te,Y as ae}from"./index-6405d5ac.js";/* empty css                   *//* empty css                *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                 */import{b as le,m as oe}from"./index-f15665f6.js";import{b as se,c as re,d as ne,e as ue,s as de}from"./api-c38e4264.js";import{_ as ie}from"./_plugin-vue_export-helper-c27b6911.js";const pe={class:"main-container"},me=M({__name:"callback",setup(_e){u(!1);const m=L();F();const _=u(!1),O=u([]),d=u(0),g=u(),y=u(),S={OrderCode:0,site_id:"",api_id:"",api_name:"",api_key:"",api_secret:"",callback_url:"",request_data:"",url:""};m.meta.title;const e=K({...S});e.id=u(m.query.id),w(()=>e.OrderCode,(r,t)=>{if(e.request_data){const l=JSON.parse(e.request_data);l.Data[0].OrderCode=e.OrderCode,console.log(l),e.request_data=JSON.stringify(l,null,2)}},{immediate:!0});const V=u();m.query.id&&(_.value=!0,se(m.query.id).then(({data:r})=>{if(r){if(Object.keys(e).forEach(t=>{r[t]!=null&&(e[t]=r[t])}),e.request_data){const t=JSON.parse(e.request_data);t.Data[0].OrderCode=e.OrderCode,console.log(t),e.request_data=JSON.stringify(t,null,2)}e.value=r.fee_data,d.value=103}_.value=!1}).catch(()=>{_.value=!1}));const N=async()=>{await(await ne()).data;const r=[["103","已分配快递员"],["104","推送已取件"],["2","推送在途中状态"],["203","订单取消"],["208","修正重量（用户举报客服对账)"],["3","已签收"],["301","揽件状态（包含费用明细）"],["401","工单回推"],["601","推送费用状态(仅指定申通下单)"],["99","调度失败"]];O.value=r},k=async()=>{y.value=await(await ue()).data,e.url=y.value};N(),k(),w(d,()=>{d.value&&re(e.site_id,d.value).then(({data:r})=>{r&&(e.api_id=d,e.request_data=JSON.stringify(r,null,2))}).catch(()=>{})});const E=A(()=>({})),c=u(!1),R=async r=>{c.value||!r||await r.validate(async t=>{if(t){c.value=!0;const l=e,n=JSON.parse(l.request_data);n.Data.OrderCode=l.OrderCode;const f=l.api_secret;l.EBusinessID=l.api_key,l.RequestData=JSON.stringify(n),l.RequestType=l.api_id;const i=le.Buffer.from(oe(JSON.stringify(n)+f)).toString("base64");l.DataSign=encodeURIComponent(i),de(y.value,l).then(p=>{c.value=!1;const b=p;console.log(p),g.value=JSON.stringify(b,null,2)}).catch(p=>{console.log(p),c.value=!1})}})};return(r,t)=>{const l=$,n=z,f=G,i=P,p=W,b=X,B=Z,h=ee,J=te,U=ae;return v(),D("div",pe,[a(J,{class:"box-card !border-none",shadow:"never"},{default:o(()=>[T((v(),q(h,{model:e,"label-width":"120px",ref_key:"formRef",ref:V,rules:C(E),class:"page-form"},{default:o(()=>[a(i,{gutter:20},{default:o(()=>[a(f,{span:12},{default:o(()=>[a(n,{label:"请求报文内容",prop:"template_name","label-position":"top"},{default:o(()=>[a(l,{modelValue:e.request_data,"onUpdate:modelValue":t[0]||(t[0]=s=>e.request_data=s),modelModifiers:{trim:!0},type:"textarea",rows:14,placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),a(f,{span:12},{default:o(()=>[a(n,{label:"返回报文",prop:"template_name","label-position":"top"},{default:o(()=>[a(l,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),modelModifiers:{trim:!0},type:"textarea",rows:14,placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(i,{gutter:20},{default:o(()=>[a(n,{label:"OrderCode",prop:"template_name"},{default:o(()=>[a(l,{modelValue:e.OrderCode,"onUpdate:modelValue":t[2]||(t[2]=s=>e.OrderCode=s),modelModifiers:{trim:!0},class:"input-width"},null,8,["modelValue"])]),_:1}),a(n,{label:"EBusinessID",prop:"template_name"},{default:o(()=>[a(l,{modelValue:e.api_key,"onUpdate:modelValue":t[3]||(t[3]=s=>e.api_key=s),modelModifiers:{trim:!0},class:"input-width"},null,8,["modelValue"])]),_:1})]),_:1}),a(i,{gutter:20},{default:o(()=>[a(n,{label:"Key",prop:"template_name"},{default:o(()=>[a(l,{modelValue:e.api_secret,"onUpdate:modelValue":t[4]||(t[4]=s=>e.api_secret=s),modelModifiers:{trim:!0},class:"input-width",style:{width:"600px"}},null,8,["modelValue"])]),_:1})]),_:1}),a(i,{gutter:20},{default:o(()=>[a(n,{label:"请求地址",prop:"template_name"},{default:o(()=>[a(l,{modelValue:e.url,"onUpdate:modelValue":t[5]||(t[5]=s=>e.url=s),modelModifiers:{trim:!0},class:"input-width",style:{width:"600px"}},null,8,["modelValue"])]),_:1})]),_:1}),a(i,{gutter:20},{default:o(()=>[a(n,{label:C(j)("status"),prop:"status"},{default:o(()=>[a(b,{modelValue:d.value,"onUpdate:modelValue":t[6]||(t[6]=s=>d.value=s),clearable:"",placeholder:"选择测试接口",class:"input-width"},{default:o(()=>[(v(!0),D(H,null,Q(O.value,(s,I)=>(v(),q(p,{label:"("+s[0]+")"+s[1],value:s[0],key:I},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),x(" "+Y(d.value),1)]),_:1},8,["label"])]),_:1}),a(i,{gutter:20},{default:o(()=>[a(n,null,{default:o(()=>[a(B,{type:"primary",onClick:t[7]||(t[7]=s=>R(V.value))},{default:o(()=>[x("发送")]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[U,_.value]])]),_:1})])}}});const ke=ie(me,[["__scopeId","data-v-b210914f"]]);export{ke as default};
