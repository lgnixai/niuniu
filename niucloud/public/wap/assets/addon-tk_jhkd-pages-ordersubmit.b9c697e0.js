import{a as e,d as t,l as a,j as l,r as s,O as d,p as r,s as o,o as u,V as n,b as i,w as c,y as f,c as m,f as p,z as x,W as _,ai as v,u as g,H as b,D as k,i as y,g as h,h as w,C as A,b_ as V,b$ as C,c0 as S,X as j,E as P,bc as $,c1 as U,B as F,R as z,c2 as T,c3 as W,b8 as I,c4 as L,aG as H,_ as B}from"./index-06110d51.js";import{_ as R}from"./share-poster.e9214e95.js";import{_ as G}from"./pay.e6ecc795.js";import{c as N,b as D,p as E,d as J,a as K}from"./tkjhkd.0c7684f3.js";import{c as M}from"./orderadd.a56c5c54.js";import"./pay.79dd7250.js";function O(t=""){M().then((t=>{"redirect"===t.data.type&&(uni.$u.toast("请先支付未补差价订单"),e({url:t.data.page}))}))}const X=B(t({__name:"ordersubmit",setup(t){const B=a(),M=l((()=>B.info));O(),s([""]),s(null),s(null);const X=s();s();const Y=s(),q=s(null),Q=s(!1);s(!1);const Z=s(!0),ee=s(!1),te=s(null),ae=s({title:"快速下单必读",description:"先地址簿添加/编辑地址，选择取/收货地址，填写物品信息，选择渠道下单",closable:!1}),le=s(["普货","文件","美妆用品","数码产品","服装鞋帽","珠宝首饰","零食特产","办公用品"]);let se=s(null),de=s(""),re={};const oe=s(0),ue=()=>{if(!M.value)return b().setLoginBack({url:"/addon/fengchao/pages/ordersubmit"}),!1;M.value&&M.value.member_id&&(re.member_id=M.value.member_id),M.value&&M.value.member_id&&(de.value+="?mid="+M.value.member_id),se.value.openShare()},ne=e=>{1==Z.value?Z.value=!1:Z.value=!0},ie=s({title:"填写须知",description:"物品名称必须填写，物品重量需按照实际重量填写,超长物品请填写实际尺寸，如需要保价请填写保价金额",closable:!1}),ce=d({startAddress:uni.getStorageSync("startAddress"),endAddress:uni.getStorageSync("endAddress"),customerType:"kd",goods:"",packageCount:1,weight:1,vloumLong:10,vloumWidth:10,vloumHeight:10,guaranteeValueAmount:null,remark:"",showPrice:"0",payMethod:"",delivery_info:[],key:"",delivery_index:"",price_rule:[],original_rule:[]}),fe=()=>{me.value=!1,ee.value=!1},me=s(!1);s(["0000","15222"]);const pe=t=>{uni.setStorage({key:"selectAddressCallback",data:{back:"/addon/fengchao/pages/ordersubmit",delivery:t,value:t},success(){e({url:"/addon/fengchao/pages/address/address",param:{type:"address"}})}})},xe=async e=>{if(e>0){return(await D(e)).data}},_e=uni.getStorageSync("selectAddressCallback");_e&&("startaddress"==_e.delivery&&xe(_e.address_id).then((e=>{uni.setStorageSync("startAddress",e),ce.startAddress=uni.getStorageSync("startAddress")})).catch((e=>{console.error(e)})),"endaddress"==_e.delivery&&xe(_e.address_id).then((e=>{uni.setStorageSync("endAddress",e),ce.endAddress=uni.getStorageSync("endAddress")})).catch((e=>{console.error(e)})),uni.removeStorage({key:"selectAddressCallback"}));const ve=s();return r((e=>{o();let t=uni.getStorageSync("pid");t&&t>0&&N({pid:t}),ce.customerType=e.type?e.type:"kd","ky"==ce.customerType&&(ce.weight=30),(async()=>{const e=await K("jhkdservice");ve.value=e.data})()})),(t,a)=>{const l=k,s=y,d=h(w("u-icon"),$),r=h(w("u-alert"),U),o=F,B=h(w("u-input"),z),N=h(w("u-tag"),T),D=h(w("u-number-box"),W),K=h(w("u-loading-icon"),I),xe=A,_e=h(w("u-safe-bottom"),L),ge=h(w("u-popup"),H),be=V,ke=C,ye=S,he=h(w("share-poster"),R),we=h(w("pay"),G);return u(),n(_,null,[i(s,{class:"tk-card1 !bg-[#ffffff]"},{default:c((()=>[i(s,{class:"fb flex items-center",style:{width:"100%"}},{default:c((()=>[i(s,{class:"w-[12%]"},{default:c((()=>[i(l,{class:"tag"},{default:c((()=>[f("寄")])),_:1})])),_:1}),i(s,{class:"w-[64%]"},{default:c((()=>[ce.startAddress==[]?(u(),m(l,{key:0,class:"font-bold"},{default:c((()=>[f("从哪里寄？")])),_:1})):p("v-if",!0),ce.startAddress==[]?(u(),m(l,{key:1,class:"tk-sltext"},{default:c((()=>[f("请选择寄件地址")])),_:1})):p("v-if",!0),ce.startAddress?(u(),m(l,{key:2,class:"font-bold tk-sltext text-sm"},{default:c((()=>[f(x(ce.startAddress.name)+" ",1),i(l,{class:"font-bold text-xs text-slate-600"},{default:c((()=>[f(x(ce.startAddress.mobile),1)])),_:1})])),_:1})):p("v-if",!0),ce.startAddress?(u(),m(l,{key:3,class:"text-xs font-bold text-[32rpx]"},{default:c((()=>[f(x(ce.startAddress.address),1)])),_:1})):p("v-if",!0)])),_:1}),i(s,{class:"w-[18%]"},{default:c((()=>[i(l,{class:"bt text-sm",onClick:a[0]||(a[0]=e=>pe("startaddress"))},{default:c((()=>[f("地址簿")])),_:1})])),_:1})])),_:1}),i(s,{class:"line-box1 mt-2"}),i(s,{class:"fb fb flex items-center mt-2",style:{width:"100%"}},{default:c((()=>[i(s,{class:"w-[12%]"},{default:c((()=>[i(l,{class:"tag",style:{background:"#4541c7",color:"#ffffff"}},{default:c((()=>[f("收")])),_:1})])),_:1}),i(s,{class:"w-[64%]"},{default:c((()=>[ce.endAddress==[]?(u(),m(s,{key:0,class:"font-bold"},{default:c((()=>[f("收件人信息？")])),_:1})):p("v-if",!0),ce.endAddress==[]?(u(),m(l,{key:1,class:"tk-sltext"},{default:c((()=>[f("请选择收件地址")])),_:1})):p("v-if",!0),ce.endAddress?(u(),m(l,{key:2,class:"font-bold tk-sltext text-sm"},{default:c((()=>[f(x(ce.endAddress.name)+" ",1),i(l,{class:"font-bold text-xs text-slate-600"},{default:c((()=>[f(x(ce.endAddress.mobile),1)])),_:1})])),_:1})):p("v-if",!0),ce.endAddress?(u(),m(l,{key:3,class:"text-xs font-bold text-[32rpx]"},{default:c((()=>[f(x(ce.endAddress.address),1)])),_:1})):p("v-if",!0)])),_:1}),i(s,{class:"w-[18%]"},{default:c((()=>[i(l,{class:"bt text-sm",onClick:a[1]||(a[1]=e=>pe("endaddress"))},{default:c((()=>[f("地址簿")])),_:1})])),_:1})])),_:1}),i(s,{class:"text-sm mt-2 text-[#686868] font-bold"},{default:c((()=>[f(" 请认真核实地址,填写实际重量再下单！ ")])),_:1})])),_:1}),i(s,{class:"tk-card1"},{default:c((()=>[i(s,{class:"fb"},{default:c((()=>[i(s,{class:"fl items-center"},{default:c((()=>[i(s,{class:"text-xs tk-tag mr-1"},{default:c((()=>[f("必填")])),_:1}),i(s,{class:"mr-2"},{default:c((()=>[f("物品信息")])),_:1}),i(s,{class:"font-weight text-[#272822] text-sm"},{default:c((()=>[f(x(ce.goods)+","+x(ce.weight)+"kg",1)])),_:1})])),_:1}),i(d,{size:"22",name:"edit-pen",onClick:a[2]||(a[2]=e=>ce.startAddress==[]?(pe("startaddress"),void uni.$u.toast("请填写取件地址")):ce.endAddress==[]?(pe("endaddress"),void uni.$u.toast("请填写送件地址")):(me.value=!0,void(ce.delivery_info=[])))})])),_:1})])),_:1}),i(s,{class:"pl-2 pr-2"},{default:c((()=>[i(r,{title:ae.value.title,type:"info",closable:ae.value.closable,description:ae.value.description},null,8,["title","closable","description"])])),_:1}),X.value?(u(),m(s,{key:0,class:"overflow-y-auto"},{default:c((()=>[(u(!0),n(_,null,v(X.value,((e,t)=>(u(),n(_,{key:t},["Y"==e.onlinePay?(u(),m(s,{key:0,class:j(["fb p-[12rpx] tk-card1",[{selectitemclass:te.value==t}]]),onClick:e=>{return a=t,te.value=a,Y.value=X.value[a],ce.showPrice=Y.value.showPrice,ce.delivery_info=Y.value,ce.delivery_index=a,ce.price_rule=Y.value.price_rule,void(ce.original_rule=Y.value.original_rule);var a}},{default:c((()=>[i(s,{class:"fl items-center",style:{width:"100%"}},{default:c((()=>[i(s,null,{default:c((()=>[i(o,{style:{width:"120rpx",height:"120rpx","border-radius":"120rpx"},src:g(P)(e.logo),mode:""},null,8,["src"])])),_:2},1024),i(s,{class:"ml-[18rpx]",style:{width:"100%"}},{default:c((()=>[i(s,{class:"flex items-center justify-between"},{default:c((()=>[i(s,{class:"font-weight text-sltext text-[30rpx]"},{default:c((()=>[f(x(e.channelName),1)])),_:2},1024),i(s,{class:"font-weight text-[32rpx]"},{default:c((()=>[f(x(e.showPrice)+"元 ",1)])),_:2},1024)])),_:2},1024),"profit"==e.calcFeeType?(u(),m(s,{key:0,class:"flex text-xs mt-2 font-bold"},{default:c((()=>[i(s,{class:"text-[26rpx] w-[40%] p-1 bg-[#eff1f9] rounded-lg text-slate-600 bg-opacity-50"},{default:c((()=>[f(" 首重:"+x(e.price_rule.first)+"元/"+x(e.price_rule.start)+"kg",1)])),_:2},1024),i(s,{class:"text-[26rpx] w-[40%] ml-2 p-1 !pb-0 bg-[#eff1f9] rounded-lg text-slate-600 bg-opacity-50"},{default:c((()=>[f(" 续重:"+x(e.price_rule.add)+"元/kg ",1)])),_:2},1024)])),_:2},1024)):(u(),m(s,{key:1},{default:c((()=>[i(s,{class:"text-[26rpx] font-bold w-[40%] ml-2 mt-2 p-1 !pb-0 bg-[#eff1f9] rounded-lg text-slate-600 bg-opacity-50 text-red-400"},{default:c((()=>[f(x((e.showPrice/e.originalFee*10).toFixed(1))+"折 ",1)])),_:2},1024)])),_:2},1024)),e.originalFee>0&&e.originalFee-e.showPrice>0?(u(),m(s,{key:2,class:"flex text-xs mt-2"},{default:c((()=>[i(s,{class:"text-[26rpx] w-[40%] p-1 bg-[#eff1f9] rounded-lg text-slate-600 bg-opacity-50"},{default:c((()=>[f(" 原价"+x(e.originalFee)+"元 ",1)])),_:2},1024),i(s,{class:"text-[26rpx] font-bold w-[40%] ml-2 p-1 !pb-0 bg-[#e6e8f1] rounded-lg text-slate-600 bg-opacity-50 text-red"},{default:c((()=>[f(" 优惠:"+x((e.originalFee-e.showPrice).toFixed(2))+"元 ",1)])),_:2},1024)])),_:2},1024)):p("v-if",!0),e.limitWeight>0?(u(),m(s,{key:3,class:"text-xs text-[#272822] mt-1 ml-1"},{default:c((()=>[f(" 限重:"+x(e.limitWeight)+"kg",1)])),_:2},1024)):p("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])):p("v-if",!0)],64)))),128))])),_:1})):p("v-if",!0),ve.value?(u(),m(s,{key:1,class:"tk-card"})):p("v-if",!0),i(s,{class:"mt-[380rpx] mb-[260rpx] flex items-center"}),p(" 物品信息弹出框 "),i(ge,{class:"safe-area-inset-bottom",round:10,onClose:fe,closeable:"true",show:me.value,mode:"bottom","border-radius":"12"},{default:c((()=>[i(s,{class:"tk-card h-[760rpx] overflow-y-auto"},{default:c((()=>[i(s,{class:"flex items-center"},{default:c((()=>[i(s,{class:"senddetail"},{default:c((()=>[f(" 物品名称 ")])),_:1}),i(B,{clearable:"true",border:"bottom",class:"mt-[8rpx] text-sm",modelValue:ce.goods,"onUpdate:modelValue":a[3]||(a[3]=e=>ce.goods=e),placeholder:"如:生活用品,点击标签快速填写"},null,8,["modelValue"])])),_:1}),i(s,{class:"fl flex-wrap mt-2"},{default:c((()=>[(u(!0),n(_,null,v(le.value,((e,t)=>(u(),m(s,{key:"index",class:"mt-1 mr-2 mb-1"},{default:c((()=>[i(N,{borderColor:"#444444",color:"#1d1d1d",text:e,type:"success",plain:"",onClick:e=>(e=>{uni.$u.toast(le.value[e]),ce.goods=le.value[e]})(t)},null,8,["text","onClick"])])),_:2},1024)))),128))])),_:1}),i(s,{class:"font-bold text-xs mt-2",onClick:a[4]||(a[4]=t=>g(e)({url:"/addon/fengchao/pages/agreement?type=jhkdyesgoods"}))},{default:c((()=>[f(" 《违禁品查询》")])),_:1}),i(s,{class:"flex items-center mt-[24rpx]"},{default:c((()=>[i(s,{class:"senddetail"},{default:c((()=>[f(" 物品重量 ")])),_:1}),i(D,{"button-size":"24",color:"#0000ff",bgColor:"#e6e6e6",iconStyle:"color: #0000ff",integer:"",min:"kd"==ce.customerType?1:30,max:1e4,class:"text-sm",modelValue:ce.weight,"onUpdate:modelValue":a[5]||(a[5]=e=>ce.weight=e)},null,8,["min","modelValue"]),i(l,{class:"ml-4 text-[#a3a3a3]"},{default:c((()=>[f("kg")])),_:1})])),_:1}),i(s,{class:"font-bold text-xs text-red"},{default:c((()=>[f("请填写打包完成后包裹的重量，超重需按照快递原价补差价，将不会享受寄件折扣")])),_:1}),i(s,{class:"flex items-center mt-[24rpx]"},{default:c((()=>[i(s,{class:"senddetail"},{default:c((()=>[f(" 包裹数量 ")])),_:1}),i(D,{"button-size":"24",color:"#0000ff",bgColor:"#e6e6e6",iconStyle:"color: #0000ff",integer:"",min:1,max:100,class:"text-sm",modelValue:ce.packageCount,"onUpdate:modelValue":a[6]||(a[6]=e=>ce.packageCount=e)},null,8,["modelValue"]),i(l,{class:"ml-4 text-[#a3a3a3]"},{default:c((()=>[f("个")])),_:1})])),_:1}),i(s,{class:"flex items-center mt-[24rpx]"},{default:c((()=>[i(s,{class:"senddetail"},{default:c((()=>[f(" 物品体积 ")])),_:1}),i(s,{class:"w-48px"},{default:c((()=>[i(B,{border:"bottom",maxlength:"3",modelValue:ce.vloumLong,"onUpdate:modelValue":a[7]||(a[7]=e=>ce.vloumLong=e)},null,8,["modelValue"])])),_:1}),i(l,{class:"text-[#a3a3a3] mr-[8rpx]"},{default:c((()=>[f("x")])),_:1}),i(s,{class:"w-48px"},{default:c((()=>[i(B,{border:"bottom",maxlength:"3",modelValue:ce.vloumWidth,"onUpdate:modelValue":a[8]||(a[8]=e=>ce.vloumWidth=e)},null,8,["modelValue"])])),_:1}),i(l,{class:"text-[#a3a3a3] mr-[8rpx]"},{default:c((()=>[f("x")])),_:1}),i(s,{class:"w-48px"},{default:c((()=>[i(B,{border:"bottom",maxlength:"3",modelValue:ce.vloumHeight,"onUpdate:modelValue":a[9]||(a[9]=e=>ce.vloumHeight=e)},null,8,["modelValue"])])),_:1}),i(l,{class:"ml-4 text-[#a3a3a3]"},{default:c((()=>[f("单位：cm")])),_:1})])),_:1}),i(s,{class:"flex items-center mt-[24rpx]"},{default:c((()=>[i(s,{class:"senddetail"},{default:c((()=>[f(" 保价金额 ")])),_:1}),i(B,{placeholder:"不保价可不填",type:"number",modelValue:ce.guaranteeValueAmount,"onUpdate:modelValue":a[10]||(a[10]=e=>ce.guaranteeValueAmount=e)},null,8,["modelValue"]),i(l,{class:"ml-4 text-[#a3a3a3]"},{default:c((()=>[f("元")])),_:1})])),_:1}),i(s,{class:"mt-4 text-sm text-[#a3a3a3]"},{default:c((()=>[f("订单备注")])),_:1}),i(B,{class:"mt-[14px]",modelValue:ce.remark,"onUpdate:modelValue":a[11]||(a[11]=e=>ce.remark=e),placeholder:"小哥辛苦了!"},null,8,["modelValue"])])),_:1}),i(s,{class:"pl-2 pr-2"},{default:c((()=>[i(r,{title:ie.value.title,type:"warning",closable:ie.value.closable,description:ie.value.description},null,8,["title","closable","description"])])),_:1}),1==ee.value?(u(),m(K,{key:0,class:"mt-4",duration:"1000",mode:"circle",on:"linear",color:"#4541c7",vertical:!0})):p("v-if",!0),0==ee.value?(u(),m(s,{key:1,class:"flex flex-1 p-4"},{default:c((()=>[i(xe,{class:"w-[100%] !h-[72rpx] leading-[72rpx] text-[26rpx] rounded-[50rpx]",style:{color:"#ffffff",backgroundColor:"#4541c7"},type:"default",onClick:a[12]||(a[12]=e=>(async()=>{if(""==ce.goods)return void uni.$u.toast("请填写物品名称");if(ce.startAddress==[])return pe("startaddress"),void uni.$u.toast("请填写取件地址");if(ce.endAddress==[])return pe("endaddress"),void uni.$u.toast("请填写送件地址");ee.value=!0;const e=await E(ce);Y.value=null,Y.value=null,ce.key=e.data.key,X.value=e.data.list,ee.value=!1,me.value=!1,ce.delivery_info=[]})())},{default:c((()=>[f(" 获取报价 ")])),_:1})])),_:1})):p("v-if",!0),1==ee.value?(u(),m(s,{key:2,class:"flex flex-1 p-4"},{default:c((()=>[i(xe,{class:"w-[100%] !h-[72rpx] leading-[72rpx] text-[26rpx] rounded-[50rpx]",style:{color:"#ffffff",backgroundColor:"#4541c7"},type:"default"},{default:c((()=>[f(" AI比价中 ")])),_:1})])),_:1})):p("v-if",!0),i(_e)])),_:1},8,["show"]),i(s,{class:"mt-[98rpx]"}),i(s,{class:"b-tabbar safe-area-inset-bottom"},{default:c((()=>[i(s,{class:"b-tabbar-back pl-2 pt-2"},{default:c((()=>[ve.value?(u(),m(s,{key:0},{default:c((()=>[i(ye,{class:"uni-list",onChange:ne},{default:c((()=>[i(ke,{class:"text-xs fl items-center uni-list-cell uni-list-cell-pd"},{default:c((()=>[i(s,null,{default:c((()=>[i(be,{color:"#3c4cde",style:{transform:"scale(0.6)"},value:"true",checked:Z.value},null,8,["checked"])])),_:1}),i(s,{onClick:a[13]||(a[13]=t=>g(e)({url:"/addon/fengchao/pages/agreement?type=jhkdservice"}))},{default:c((()=>[f(" 阅读并同意《"+x(ve.value.title?ve.value.title:"寄件服务协议")+"》",1)])),_:1})])),_:1})])),_:1})])),_:1})):p("v-if",!0),i(s,{class:"fb items-center pl-2 pr-2 pb-2 pt-1"},{default:c((()=>[i(s,{class:"w-[60%]"},{default:c((()=>[i(s,{class:"flex items-center"},{default:c((()=>[i(s,{class:"text-xs font-bold tk-sltext text-[30rpx] w-[40%]"},{default:c((()=>[f(x(Y.value?Y.value.channelName:"请选择快递"),1)])),_:1}),""!=ce.goods?(u(),m(s,{key:0,class:"ml-2 text-xs text-slate-500"},{default:c((()=>[f(x(ce.goods)+x(ce.weight)+"kg ",1)])),_:1})):p("v-if",!0)])),_:1}),Y.value?(u(),m(s,{key:0,class:"flex items-center mt-1"},{default:c((()=>[i(s,{class:"text-xs"},{default:c((()=>[f("快递费：")])),_:1}),i(s,{class:"font-bold text-[36rpx] text-red"},{default:c((()=>[f(x(Y.value?Y.value.showPrice+"元":"请先选择快递"),1)])),_:1})])),_:1})):p("v-if",!0)])),_:1}),i(l,{class:"tt-bbut text-center w-[20%]",onClick:a[14]||(a[14]=e=>(async()=>{var e;if(O(),!M.value)return b().setLoginBack({url:"/addon/fengchao/pages/ordersubmit"}),!1;if(""==ce.goods)return me.value=!0,void uni.$u.toast("请填写物品名称");if(ce.startAddress==[])return pe("startaddress"),void uni.$u.toast("请填写取件地址");if(ce.endAddress==[])return pe("endaddress"),void uni.$u.toast("请填写送件地址");if(null==X.value)return void uni.$u.toast("请完善信息再获取报价");if(null==Y.value)return void uni.$u.toast("请选择发货渠道");if(0==Z.value)return void uni.$u.toast("请先阅读并同意协议");const t=await J(ce);ce.delivery_info=[],Y.value=null,X.value=null,Q.value=!0,null==(e=q.value)||e.open(t.data.trade_type,t.data.trade_id,"/addon/fengchao/pages/orderlist")})())},{default:c((()=>[f("立即下单")])),_:1})])),_:1})])),_:1}),i(_e)])),_:1}),i(xe,{onClick:a[15]||(a[15]=e=>ue()),class:"fixed bottom-48 right-4 z-50 rounded-full p-2 text-white hover:bg-blue-700"},{default:c((()=>[i(d,{name:"share",color:"#000000",size:"24"})])),_:1}),i(he,{ref_key:"sharePosterRef",ref:se,posterType:"fengchao_poster",posterId:oe.value,posterParam:g(re),copyUrlParam:g(de)},null,8,["posterId","posterParam","copyUrlParam"]),i(we,{ref_key:"payRef",ref:q,onClose:a[16]||(a[16]=e=>Q.value=!1)},null,512)],64)}}}),[["__scopeId","data-v-c439983b"]]);export{X as default};
