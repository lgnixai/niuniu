import{d as e,r as a,p as l,aW as t,j as r,o as d,c as s,w as o,b as u,u as i,y as n,z as c,bV as m,A as p,n as v,aV as b,aY as _,a as f,g as h,h as g,i as x,F as y,R as V,S as k,aZ as P,bW as j,bX as w,T as $,_ as C}from"./index-06110d51.js";import{_ as A}from"./area-select.vue_vue_type_script_setup_true_lang.595e9baa.js";import{f as E}from"./tkjhkd.0c7684f3.js";const T=C(e({__name:"address_edit",setup(e){const C=a(),T=a({id:0,name:"",mobile:"",province_id:0,city_id:0,district_id:0,address:"",full_address:"",is_default:0,area:"",type:"address"}),U=a(),q=a(null),R=a(""),W=a(""),z=a(!1),F=()=>{setTimeout((()=>{K()}),500)},K=()=>{C.value?E({address:C.value}).then((e=>{Object.assign(T.value,e.data),uni.$u.toast("地址解析成功"),C.value=""})):uni.$u.toast("请填写解析地址")};l((e=>{e.id&&t(e.id).then((({data:e})=>{e&&Object.assign(T.value,e)})).catch(),R.value=e.type||"",W.value=e.source||""}));const M=r((()=>({name:{type:"string",required:!0,message:y("namePlaceholder"),trigger:["blur","change"]},mobile:[{type:"string",required:!0,message:y("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,a,l){/^1[3-9]\d{9}$/.test(a)?l():l(new Error(y("mobileError")))}}],area:{validator:()=>!uni.$u.test.isEmpty(T.value.area),message:y("selectAreaPlaceholder")},address:{type:"string",required:!0,message:y("addressPlaceholder"),trigger:["blur","change"]}}))),O=()=>{U.value.open()},S=e=>{T.value.province_id=e.province.id||0,T.value.city_id=e.city.id||0,T.value.district_id=e.district.id||0,T.value.area=`${e.province.name||""}${e.city.name||""}${e.district.name||""}`},H=a(!1),I=()=>{const e=T.value.id?b:_;q.value.validate().then((()=>{H.value||(H.value=!0,z.value=!0,T.value.full_address=T.value.area+T.value.address,e(T.value).then((e=>{H.value=!1,setTimeout((()=>{z.value=!1,f({url:"/addon/tk_jhkd/pages/address/address",mode:"redirectTo",param:{type:R.value,source:W.value}})}),1e3)})).catch((()=>{H.value=!1,z.value=!1})))}))};return(e,a)=>{const l=h(g("u-input"),V),t=h(g("u-form-item"),k),r=x,b=h(g("u-switch"),P),_=h(g("u-textarea"),j),f=h(g("u-button"),w),E=h(g("u-form"),$),R=h(g("area-select"),A);return d(),s(r,{class:"px-[30rpx]",style:v(e.themeColor())},{default:o((()=>[u(E,{labelPosition:"left",model:T.value,labelWidth:"200rpx",errorType:"toast",rules:i(M),ref_key:"formRef",ref:q},{default:o((()=>[u(r,{class:"mt-[10rpx]"},{default:o((()=>[u(t,{label:i(y)("name"),prop:"name","border-bottom":!0},{default:o((()=>[u(l,{modelValue:T.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>T.value.name=e),modelModifiers:{trim:!0},border:"none",clearable:"",maxlength:"25",placeholder:i(y)("namePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),u(r,{class:"mt-[10rpx]"},{default:o((()=>[u(t,{label:i(y)("mobile"),prop:"mobile","border-bottom":!0},{default:o((()=>[u(l,{modelValue:T.value.mobile,"onUpdate:modelValue":a[1]||(a[1]=e=>T.value.mobile=e),border:"none",clearable:"",placeholder:i(y)("mobilePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),u(r,{class:"mt-[10rpx]"},{default:o((()=>[u(t,{label:i(y)("selectArea"),prop:"area","border-bottom":!0,onClick:O},{default:o((()=>[T.value.area?(d(),s(r,{key:1,class:"text-[30rpx]"},{default:o((()=>[n(c(T.value.area),1)])),_:1})):(d(),s(r,{key:0,class:"text-gray-placeholder text-[30rpx]"},{default:o((()=>[n(c(i(y)("selectAreaPlaceholder")),1)])),_:1}))])),_:1},8,["label"])])),_:1}),u(r,{class:"mt-[10rpx]"},{default:o((()=>[u(t,{label:i(y)("address"),prop:"address","border-bottom":!0},{default:o((()=>[u(l,{modelValue:T.value.address,"onUpdate:modelValue":a[2]||(a[2]=e=>T.value.address=e),modelModifiers:{trim:!0},border:"none",clearable:"",maxlength:"120",placeholder:i(y)("addressPlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),u(r,{class:"mt-[10rpx]"},{default:o((()=>[u(t,{label:i(y)("defaultAddress"),prop:"name","border-bottom":!0},{default:o((()=>[u(b,{modelValue:T.value.is_default,"onUpdate:modelValue":a[3]||(a[3]=e=>T.value.is_default=e),size:"20",activeValue:1,inactiveValue:0,activeColor:"var(--primary-color)"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),u(r,{class:"tk-card1 p-2 mt-4 mb-4"},{default:o((()=>[u(_,{clearable:"",border:"none",modelValue:C.value,"onUpdate:modelValue":a[4]||(a[4]=e=>C.value=e),height:"40",placeholder:"在此处输入粘贴地址可以快速自动识别",maxlength:"240",onKeydown:[m(e.handleEnter,["enter"]),m(p(e.handleShiftEnter,["shift"]),["enter"])],onPaste:F,autoHeight:""},null,8,["modelValue","onKeydown"]),u(r,{class:"text-xs text-center bg-[#4f38ce] text-white p-1 rounded-[60px] w-[20%]",onClick:a[5]||(a[5]=e=>K())},{default:o((()=>[n(" 地址识别 ")])),_:1})])),_:1}),u(r,{class:"mt-[40rpx]"},{default:o((()=>[u(f,{type:"primary",shape:"circle",text:i(y)("save"),onClick:I,disabled:z.value,loading:H.value},null,8,["text","disabled","loading"])])),_:1})])),_:1},8,["model","rules"]),u(R,{ref_key:"areaRef",ref:U,onComplete:S,"area-id":T.value.district_id},null,8,["area-id"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-68b9da34"]]);export{T as default};
