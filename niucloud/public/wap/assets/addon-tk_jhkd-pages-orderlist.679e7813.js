import{c7 as e,d as a,r as t,p as s,o as l,V as r,b as o,w as d,c as n,W as f,ai as c,f as u,u as i,aj as _,ak as m,i as x,ah as p,g as v,h as y,X as g,y as k,z as b,bS as h,E as I,D as w,bc as j,a7 as C,_ as S}from"./index-06110d51.js";import{_ as R}from"./tabbar.4bca783d.js";import{_ as z}from"./pay.e6ecc795.js";import{g as M,a as O,d as E,c as J,b as U}from"./order.22aa3725.js";import{u as N,M as D}from"./useMescroll.d9213849.js";import{M as L}from"./mescroll-empty.5d0f3d24.js";import{g as A}from"./goto.1ed07f13.js";import"./pay.79dd7250.js";import"./mescroll-i18n.8d7056c6.js";async function B(a,t,s){e({title:"操作提示",content:a,confirmColor:"#3569EA",cancelColor:"#646464",success:function(e){e.confirm?t(s):e.cancel&&console.log("用户点击取消")}})}const q=S(a({__name:"orderlist",setup(e){const a=t(null),S=t(!1),q=t({show:!1,msg:""}),{mescrollInit:G,downCallback:P,getMescroll:V}=N(m,_),W=t([]),X=t(!1),Y=t(!1),F=t(""),H=t([]);s((e=>{F.value=e.status||"",ee()}));const K=e=>{var t;S.value=!0,null==(t=a.value)||t.open(e.payInfo.trade_type,e.payInfo.trade_id,"/addon/fengchao/pages/orderlist?status="+F.value)},Q=async e=>{await E(e.id),V().resetUpScroll()},T=async e=>{await J(e.id),V().resetUpScroll()},Z=async e=>{const a={id:e.id,close_reason:"用户主动退款"};await U(a),V().resetUpScroll()},$=e=>{X.value=!1;const a={page:e.num,limit:e.size,order_status:F.value};O(a).then((a=>{const t=a.data.data;1===e.num&&(W.value=[]),W.value=W.value.concat(t),e.endSuccess(t.length),X.value=!0})).catch((()=>{X.value=!0,e.endErr()}))},ee=()=>{Y.value=!1,H.value=[];H.value.push({name:"全部",status:""}),M().then((e=>{Object.values(e.data).forEach((e=>{H.value.push(e)})),Y.value=!0})).catch((()=>{Y.value=!0}))};return(e,t)=>{const s=x,_=p,m=w,M=v(y("up-icon"),j),O=v(y("up-modal"),C),E=v(y("tabbar"),R),J=v(y("pay"),z);return l(),r(f,null,[o(s,{class:"bg-[#f8f8f8] min-h-screen overflow-hidden"},{default:d((()=>[Y.value?(l(),n(s,{key:0,class:"fixed left-0 top-0 right-0 z-10"},{default:d((()=>[o(_,{"scroll-x":"true",class:"scroll-Y box-border px-[24rpx] bg-white"},{default:d((()=>[o(s,{class:"flex whitespace-nowrap justify-around"},{default:d((()=>[(l(!0),r(f,null,c(H.value,((e,a)=>(l(),n(s,{class:g(["text-sm leading-[90rpx]",{"class-select":F.value===e.status.toString()}]),onClick:a=>{return t=e.status,F.value=t.toString(),W.value=[],void V().resetUpScroll();var t}},{default:d((()=>[k(b(e.name),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1})):u("v-if",!0),o(s,{class:"h-[44rpx]"}),o(D,{ref:"mescrollRef",top:"44rpx",onInit:i(G),onDown:i(P),onUp:$},{default:d((()=>[W.value.length>0?(l(!0),r(f,{key:0},c(W.value,((e,t)=>(l(),n(s,{class:"tk-card m-2 mt-4 rounded-xl shadow-xl",key:t},{default:d((()=>[o(s,{class:"fb flex justify-between"},{default:d((()=>[o(s,{class:"text-xs font-weight"},{default:d((()=>[k(" 订单号:"+b(e.order_id)+" ",1),e.orderInfo.delivery_id?(l(),n(s,{key:0,class:"flex items-center",onClick:a=>i(h)(e.orderInfo.delivery_id)},{default:d((()=>[o(m,{class:"mr-2 text-primary text-xs mt-1"},{default:d((()=>[k("运单号:"+b(e.orderInfo.delivery_id),1)])),_:2},1024),o(s,null,{default:d((()=>[o(M,{class:"border-1 rounded",name:"cut",color:"#4541c7",size:"16"})])),_:1})])),_:2},1032,["onClick"])):u("v-if",!0)])),_:2},1024),"已关闭"==e.order_status_data.name?(l(),n(s,{key:0,class:"text-xs h-5 text-red-600"},{default:d((()=>[k(b(e.order_status_data.name),1)])),_:2},1024)):(l(),n(s,{key:1,class:"text-xs h-5"},{default:d((()=>[k(b(e.order_status_data.name),1)])),_:2},1024))])),_:2},1024),o(s,{class:"flex justify-center mt-3"},{default:d((()=>[o(s,{class:"flex items-center"},{default:d((()=>[o(s,{class:"mr-2"},{default:d((()=>[o(m,{class:"qu-tag text-sm p-2 rounded-xl"},{default:d((()=>[k("寄")])),_:1})])),_:1}),o(s,{class:"flex flex-col items-center"},{default:d((()=>[o(s,{class:"text-sm font-bold flex"},{default:d((()=>[o(s,{class:""},{default:d((()=>[k(b(JSON.parse(e.orderInfo.start_address).address.split("-")[0]),1)])),_:2},1024)])),_:2},1024),o(s,{class:"tk-sltext text-xs text-[#4b4b4b]"},{default:d((()=>[k(b(JSON.parse(e.orderInfo.start_address).name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),o(s,{class:"flex items-center ml-4 mr-4"},{default:d((()=>[o(s,{class:"flex"},{default:d((()=>[o(s,null,{default:d((()=>[o(M,{name:"more-dot-fill",color:"#63625f",size:"28"})])),_:1}),o(s,null,{default:d((()=>[o(M,{name:"more-dot-fill",color:"#63625f",size:"28"})])),_:1}),o(s,null,{default:d((()=>[o(M,{name:"arrow-right",color:"#63625f",size:"28"})])),_:1})])),_:1})])),_:1}),o(s,{class:"flex items-center"},{default:d((()=>[o(s,{class:"mr-4"},{default:d((()=>[o(m,{class:"song-tag text-sm p-2 rounded-xl"},{default:d((()=>[k("收")])),_:1})])),_:1}),o(s,{class:""},{default:d((()=>[o(s,{class:"flex flex-col items-center"},{default:d((()=>[o(s,{class:"text-sm font-bold flex"},{default:d((()=>[o(s,{class:""},{default:d((()=>[k(b(JSON.parse(e.orderInfo.end_address).address.split("-")[0]),1)])),_:2},1024)])),_:2},1024),o(s,{class:"tk-sltext text-xs text-[#4b4b4b]"},{default:d((()=>[k(b(JSON.parse(e.orderInfo.end_address).name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),o(s,{class:"flex mt-4 items-center justify-between"},{default:d((()=>[o(s,{class:"text-xs text-slate-600"},{default:d((()=>[k("下单时间:"+b(e.create_time),1)])),_:2},1024),o(s,{class:"text-red font-bold text-[32rpx]"},{default:d((()=>[k("￥"+b(e.order_money),1)])),_:2},1024)])),_:2},1024),o(s,{class:"text-[16rpx] pl-1 mt-1 text-[#7e7e7e]"},{default:d((()=>[k(" 注意：下单 1 分钟后才能取消订单哦")])),_:1}),e.addorderInfo&&e.deliveryRealInfo.fee_weight>0&&0==e.addorderInfo.order_status?(l(),n(s,{key:0},{default:d((()=>[o(s,{class:"line-box1"}),o(s,{class:"flex items-center mt-1 mb-2 flex text-xs font-bold p-2 text-[24rpx] bg-[#e5fffb] rounded-lg text-red bg-opacity-50"},{default:d((()=>[e.deliveryRealInfo.fee_weight>e.orderInfo.weight?(l(),n(s,{key:0,class:""},{default:d((()=>[k(" 超重: "+b(Math.ceil(e.deliveryRealInfo.fee_weight-e.orderInfo.weight))+"kg;￥"+b(Math.ceil(e.deliveryRealInfo.fee_weight-e.orderInfo.weight)*e.orderInfo.price_rule.add)+"; ",1)])),_:2},1024)):u("v-if",!0),e.deliveryRealInfo.fee_blockList?(l(!0),r(f,{key:1},c(e.deliveryRealInfo.fee_blockList,((e,a)=>(l(),n(s,{class:""},{default:d((()=>[k(b(e.name)+":￥"+b(e.fee),1)])),_:2},1024)))),256)):u("v-if",!0)])),_:2},1024),o(s,{class:"flex justify-end mt-1 items-center"},{default:d((()=>[o(s,{class:"font-bold text-red text-[28rpx]"},{default:d((()=>[k(" 需补差价:￥"+b(e.addorderInfo.order_money),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)):(l(),n(s,{key:1},{default:d((()=>[o(s,{class:"flex"},{default:d((()=>[e.addorderInfo&&1==e.addorderInfo.order_status?(l(),n(s,{key:0,class:"flex text-xs font-bold ml-2 p-2 text-[24rpx] bg-[#e5fffb] rounded-lg text-red bg-opacity-50"},{default:d((()=>[k(" 已补差价：￥ "+b(e.addorderInfo.order_money),1)])),_:2},1024)):u("v-if",!0)])),_:2},1024)])),_:2},1024)),o(s,{class:"line-box1"}),o(s,{class:"flex mt-2 items-center justify-between"},{default:d((()=>[o(s,{class:"flex"},{default:d((()=>[e.order_status_arr?(l(!0),r(f,{key:0},c(e.order_status_arr.member_action,((a,t)=>(l(),n(s,{class:"tk-tag mr-4",onClick:t=>((e,a)=>{"gopay"===e?K(a):"del"===e?B("确定要删除订单吗？",Q,a):"refund"===e?B("确定要申请退款吗？",Z,a):"close"===e&&B("确定要关闭订单吗？",T,a)})(a.class,e)},{default:d((()=>[k(b(a.name),1)])),_:2},1032,["onClick"])))),256)):u("v-if",!0)])),_:2},1024),o(s,{class:"flex"},{default:d((()=>[o(s,{class:"tk-tag",onClick:a=>i(A)("/addon/fengchao/pages/orderdetail?id="+e.id)},{default:d((()=>[k("查看详情")])),_:2},1032,["onClick"]),e.addorderInfo&&0==e.addorderInfo.order_status?(l(),n(s,{key:0,onClick:t=>{return s=e.addorderInfo.id,S.value=!0,void(null==(l=a.value)||l.open("jhkdOrderAddPay",s,"/addon/fengchao/pages/orderlist"));var s,l},class:"tk-tag1 ml-2"},{default:d((()=>[k("补差价")])),_:2},1032,["onClick"])):u("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)):u("v-if",!0),!W.value.length&&X.value?(l(),n(L,{key:1,option:{icon:i(I)("static/resource/images/empty.png")}},null,8,["option"])):u("v-if",!0)])),_:1},8,["onInit","onDown"])])),_:1}),o(O,{show:q.value.show,onConfirm:t[0]||(t[0]=a=>i(B)(e.item1.class,e.item)),ref:"uModal",onCancel:t[1]||(t[1]=e=>q.value.show=!1),showCancelButton:!0,content:q.value.msg,asyncClose:!0},null,8,["show","content"]),o(E,{addon:"fengchao"}),o(J,{ref_key:"payRef",ref:a,onClose:t[2]||(t[2]=e=>S.value=!1)},null,512)],64)}}}),[["__scopeId","data-v-49788741"]]);export{q as default};
